{"remainingRequest":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/src/components/ebook/EbookBookMark.vue?vue&type=style&index=0&id=3369f943&lang=scss&scoped=true&","dependencies":[{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/src/components/ebook/EbookBookMark.vue","mtime":1588180711005},{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Mine-Project/Book_Web_App/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgIi4uLy4uL2Fzc2V0cy9zdHlsZXMvZ2xvYmFsLnNjc3MiOwoKLmVib29rLWJvb2ttYXJrIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiBweDJyZW0oLTM1KTsKICBsZWZ0OiAwOwogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogcHgycmVtKDM1KTsKICB6LWluZGV4OiAyMDA7CgogIC5lYm9vay1ib29rbWFyay10ZXh0LXdyYXBwZXIgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgcmlnaHQ6IHB4MnJlbSg0NSk7CiAgICBib3R0b206IDA7CiAgICBkaXNwbGF5OiBmbGV4OwoKICAgIC5lYm9vay1ib29rbWFyay1kb3duLXdyYXBwZXIgewogICAgICBmb250LXNpemU6IHB4MnJlbSgxNCk7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgbGluZWFyOwogICAgICBAaW5jbHVkZSBjZW50ZXI7CiAgICB9CgogICAgLmVib29rLWJvb2ttYXJrLXRleHQgewogICAgICBmb250LXNpemU6IHB4MnJlbSgxNCk7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgIH0KICB9CgogIC5lYm9vay1ib29rbWFyay1pY29uLXdyYXBwZXIgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgcmlnaHQ6IDA7CiAgICBib3R0b206IDA7CiAgICBtYXJnaW4tcmlnaHQ6IHB4MnJlbSgxNSk7CiAgfQp9Cg=="},{"version":3,"sources":["EbookBookMark.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+KA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EbookBookMark.vue","sourceRoot":"src/components/ebook","sourcesContent":["<template>\n  <div class=\"ebook-bookmark\" ref=\"bookmark\">\n    <div class=\"ebook-bookmark-text-wrapper\">\n      <div class=\"ebook-bookmark-down-wrapper\" ref=\"icondown\">\n        <span class=\"icon-down\"></span>\n      </div>\n      <div class=\"ebook-bookmark-text\">{{text}}</div>\n    </div>\n    <div class=\"ebook-bookmark-icon-wrapper\" :style=\"isFixed?FixedStyle:{}\">\n      <Bookmark :color=\"color\" :width=\"15\" :height=\"35\"></Bookmark>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { realPx } from '../../utils/utils.js'\n  import { ebookMinx } from '../../utils/mixin.js'\n  import Bookmark from '../common/Bookmark.vue'\n  import { getBookmark, saveBookmark } from '../../utils/localstorage.js'\n\n  const BLUE = '#346cbc'\n  const WHITE = '#ffffff'\n  export default {\n    mixins: [ebookMinx],\n    components: {\n      Bookmark\n    },\n    data() {\n      return {\n        text: '',\n        color: WHITE,\n        isFixed: false\n      }\n    },\n    computed: {\n      height() {\n        return realPx(35)\n      },\n      threshold() {\n        return realPx(55)\n      },\n      FixedStyle() {\n        return {\n          position: 'fixed',\n          top: '0',\n          right: `${(window.innerWidth - this.$refs.bookmark.clientWidth) / 2}`\n        }\n      }\n    },\n    methods: {\n      beforeHeight(v) {\n        // stateOne\n        if (this.isBookmark) {\n          this.text = this.$t('book.pulldownDeleteMark')\n          this.color = BLUE\n          this.isFixed = true\n        } else {\n          this.text = this.$t('book.pulldownAddMark')\n          this.color = WHITE\n          this.isFixed = false\n        }\n      },\n      beforeThreshold(v) {\n        // stateTwo\n        this.$refs.bookmark.style.top = `${-v}px`\n        if (this.isBookmark) {\n          this.text = this.$t('book.pulldownDeleteMark')\n          this.color = BLUE\n        } else {\n          this.text = this.$t('book.pulldownAddMark')\n          this.color = WHITE\n        }\n\n        const iconDown = this.$refs.icondown\n        if (iconDown.style.transform === 'rotate(180deg)') {\n          iconDown.style.transform = 'rotate(0deg)'\n        }\n      },\n      afterThreshold(v) {\n        // stateThree\n        this.$refs.bookmark.style.top = `${-v}px`\n        if (this.isBookmark) {\n          this.text = this.$t('book.releaseDeleteMark')\n          this.isFixed = false\n          this.color = WHITE\n        } else {\n          this.text = this.$t('book.releaseAddMark')\n          this.isFixed = true\n          this.color = BLUE\n        }\n        const iconDown = this.$refs.icondown\n        if (\n          iconDown.style.transform === '' ||\n          iconDown.style.transform === 'rotate(0deg)'\n        ) {\n          iconDown.style.transform = 'rotate(180deg)'\n        }\n      },\n      restore() {\n        // stateFour\n        setTimeout(() => {\n          this.$refs.bookmark.style.top = `$ { -this.height }px`\n          this.$refs.icondown.style.transform = 'rotate(0deg)'\n        }, 200)\n        if (this.isFixed) {\n          this.setIsBookmark(true)\n          this.addBookmark()\n        } else {\n          this.setIsBookmark(false)\n          this.removeBookmark()\n        }\n      },\n      addBookmark() {\n        this.bookmark = getBookmark(this.fileName)\n        if (!this.bookmark) {\n          this.bookmark = []\n        }\n        const currentLocation = this.currentBook.rendition.currentLocation()\n        const cfiBase = currentLocation.start.cfi.replace(/!.*/, '')\n        const cfiStart = currentLocation.start.cfi\n          .replace(/.*!/, '')\n          .replace(/\\)$/, '')\n        const cfiEnd = currentLocation.end.cfi\n          .replace(/.*!/, '')\n          .replace(/\\)$/, '')\n        const cfiRange = `${cfiBase}!,${cfiStart},${cfiEnd})`\n        this.currentBook.getRange(cfiRange).then(range => {\n          const text = range.toString().replace(/\\s\\s/g, '')\n          this.bookmark.push({\n            cfi: currentLocation.start.cfi,\n            text: text\n          })\n          saveBookmark(this.fileName, this.bookmark)\n        })\n      },\n      removeBookmark() {\n        const currentLocation = this.currentBook.rendition.currentLocation()\n        const cfi = currentLocation.start.cfi\n        this.bookmark = getBookmark(this.fileName)\n        if (this.bookmark) {\n          this.bookmark = this.bookmark.filter(item => item.cfi !== cfi)\n          saveBookmark(this.fileName, this.bookmark)\n          this.setIsBookmark(false)\n        }\n      }\n    },\n    watch: {\n      offsetY(v) {\n        if (!this.bookAvailable || this.menuVisible || this.settingVisible >= 0) {\n          return\n        }\n        if (v >= this.height && v < this.threshold) {\n          this.beforeThreshold(v)\n        } else if (v >= this.threshold) {\n          this.afterThreshold(v)\n        } else if (v > 0 && v < this.height) {\n          this.beforeHeight()\n        } else if (v === 0) {\n          this.restore()\n        }\n      },\n      isBookmark(isBookmark) {\n        if (isBookmark) {\n          this.color = BLUE\n          this.isFixed = true\n        } else {\n          this.color = WHITE\n          this.isFixed = false\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  @import \"../../assets/styles/global.scss\";\n\n  .ebook-bookmark {\n    position: absolute;\n    top: px2rem(-35);\n    left: 0;\n    width: 100%;\n    height: px2rem(35);\n    z-index: 200;\n\n    .ebook-bookmark-text-wrapper {\n      position: absolute;\n      right: px2rem(45);\n      bottom: 0;\n      display: flex;\n\n      .ebook-bookmark-down-wrapper {\n        font-size: px2rem(14);\n        color: white;\n        transition: all 0.2s linear;\n        @include center;\n      }\n\n      .ebook-bookmark-text {\n        font-size: px2rem(14);\n        color: white;\n      }\n    }\n\n    .ebook-bookmark-icon-wrapper {\n      position: absolute;\n      right: 0;\n      bottom: 0;\n      margin-right: px2rem(15);\n    }\n  }\n</style>\n"]}]}