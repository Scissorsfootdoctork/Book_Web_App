{"remainingRequest":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/components/shelf/ShelfGroupDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/components/shelf/ShelfGroupDialog.vue","mtime":1590868216822},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFYm9va0RpYWxvZyBmcm9tICcuLi9jb21tb24vRGlhbG9nJwppbXBvcnQgeyBzdG9yZVNoZWxmTWl4aW4gfSBmcm9tICcuLi8uLi91dGlscy9taXhpbicKaW1wb3J0IHsgcmVtb3ZlQWRkRnJvbVNoZWxmLCBhcHBlbmRBZGRUb1NoZWxmIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3RvcmUnCmltcG9ydCB7IHNhdmVCb29rU2hlbGYgfSBmcm9tICcuLi8uLi91dGlscy9sb2NhbHN0b3JhZ2UnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnZ3JvdXAtZGlhbG9nJywKICAgIG1peGluczogW3N0b3JlU2hlbGZNaXhpbl0sCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgRWJvb2tEaWFsb2cKICAgIH0sCiAgICBwcm9wczogewogICAgICAgIGlzSW5Hcm91cDogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIGRlZmF1bHRDYXRlZ29yeSgpIHsKICAgICAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy4kdCgnc2hlbGYubmV3R3JvdXAnKSwKICAgICAgICAgICAgICAgICAgICBlZGl0OiAxCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLiR0KCdzaGVsZi5ncm91cE91dCcpLAogICAgICAgICAgICAgICAgICAgIGVkaXQ6IDIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgY2F0ZWdvcnkoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnNoZWxmTGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09IDIpCiAgICAgICAgfSwKICAgICAgICBjYXRlZ29yeUxpc3QoKSB7CiAgICAgICAgICAgIHJldHVybiBbLi4udGhpcy5kZWZhdWx0Q2F0ZWdvcnksIC4uLnRoaXMuY2F0ZWdvcnldCiAgICAgICAgfSwKICAgICAgICB0aXRsZSgpIHsKICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlmTmV3R3JvdXAgPyB0aGlzLiR0KCdzaGVsZi5tb3ZlQm9vaycpIDogdGhpcy4kdCgnc2hlbGYubmV3R3JvdXAnKQogICAgICAgIH0KICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGlmTmV3R3JvdXA6IGZhbHNlLAogICAgICAgICAgICBuZXdHcm91cE5hbWU6ICcnCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBzaG93KCkgewogICAgICAgICAgICB0aGlzLiRyZWZzLmRpYWxvZy5zaG93KCkKICAgICAgICB9LAogICAgICAgIGhpZGUoKSB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuZGlhbG9nLmhpZGUoKQogICAgICAgICAgICB0aGlzLmlmTmV3R3JvdXAgPSBmYWxzZQogICAgICAgIH0sCiAgICAgICAgb25Hcm91cENsaWNrKGl0ZW0pIHsKICAgICAgICAgICAgaWYgKGl0ZW0uZWRpdCAmJiBpdGVtLmVkaXQgPT09IDEpIHsKICAgICAgICAgICAgICAgIHRoaXMuaWZOZXdHcm91cCA9IHRydWUKICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmVkaXQgJiYgaXRlbS5lZGl0ID09PSAyKSB7CiAgICAgICAgICAgICAgICB0aGlzLm1vdmVPdXRGcm9tR3JvdXAoaXRlbSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvR3JvdXAoaXRlbSkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2xlYXIoKSB7CiAgICAgICAgICAgIHRoaXMubmV3R3JvdXBOYW1lID0gJycKICAgICAgICB9LAogICAgICAgIG1vdmVUb0dyb3VwKGdyb3VwKSB7CiAgICAgICAgICAgIHRoaXMuc2V0U2hlbGZMaXN0KHRoaXMuc2hlbGZMaXN0CiAgICAgICAgICAgIC5maWx0ZXIoYm9vayA9PiB0aGlzLnNoZWxmU2VsZWN0ZWQuaW5kZXhPZihib29rKSA8IDApKQogICAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZ3JvdXAgJiYgZ3JvdXAuaXRlbUxpc3QpIHsKICAgICAgICAgICAgICAgICAgICBncm91cC5pdGVtTGlzdCA9IFsuLi5ncm91cC5pdGVtTGlzdCwgLi4udGhpcy5zaGVsZlNlbGVjdGVkXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZ3JvdXAuaXRlbUxpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgICBpdGVtLmlkID0gaW5kZXggKyAxCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgdGhpcy5zaW1wbGVUb2FzdCh0aGlzLiR0KCdzaGVsZi5tb3ZlQm9va0luU3VjY2VzcycpLnJlcGxhY2UoJyQxJywgZ3JvdXAudGl0bGUpKQogICAgICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIG1vdmVPdXRGcm9tR3JvdXAoaXRlbSkgewogICAgICAgIH0sCiAgICAgICAgY3JlYXRlTmV3R3JvdXAoKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5uZXdHcm91cE5hbWUgJiYgdGhpcy5uZXdHcm91cE5hbWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBncm91cCA9IHsKICAgICAgICAgICAgICAgIGlkOiB0aGlzLnNoZWxmTGlzdFt0aGlzLnNoZWxmTGlzdC5sZW5ndGggLSAyXS5pZCArIDEsCiAgICAgICAgICAgICAgICBpdGVtTGlzdDogW10sCiAgICAgICAgICAgICAgICBzZWxlY3RlZDogZmFsc2UsCiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5uZXdHcm91cE5hbWUsCiAgICAgICAgICAgICAgICB0eXBlOiAyCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgbGlzdCA9IHJlbW92ZUFkZEZyb21TaGVsZih0aGlzLnNoZWxmTGlzdCkKICAgICAgICAgICAgbGlzdC5wdXNoKGdyb3VwKQogICAgICAgICAgICB0aGlzLnNldFNoZWxmTGlzdChhcHBlbmRBZGRUb1NoZWxmKGxpc3QpKQogICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKQogICAgICAgIH0sCiAgICAgICAgb25Db21wbGV0ZSgpIHsKICAgICAgICAgICAgc2F2ZUJvb2tTaGVsZih0aGlzLnNoZWxmTGlzdCkKICAgICAgICAgICAgdGhpcy5oaWRlKCkKICAgICAgICAgICAgdGhpcy5zZXRJc0VkaXRNb2RlKGZhbHNlKQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["ShelfGroupDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShelfGroupDialog.vue","sourceRoot":"src/components/shelf","sourcesContent":["<template>\n    <ebook-dialog :title=\"title\" ref=\"dialog\">\n        <div class=\"dialog-list-wrapper\" v-if=\"!ifNewGroup\">\n            <div class=\"dialog-list-item\"\n                 :class=\"{'is-add': item.edit  ? item.edit === 1 : false}\"\n                 v-for=\"(item, index) in categoryList\"\n                 :key=\"index\"\n                 @click=\"onGroupClick(item)\"\n                 v-show=\"(item.edit === 2 && isInGroup) || item.edit !== 2 || !item.edit\">\n                <div class=\"dialog-list-item-text\">{{item.title}}</div>\n                <div class=\"dialog-list-icon-wrapper\" v-if=\"category && item.id ? category.id === item.id : false\">\n                    <span class=\"icon-check\"></span>\n                </div>\n            </div>\n        </div>\n        <div class=\"dialog-new-group-wrapper\" v-else>\n            <div class=\"dialog-input-title-wrapper\">\n                <span class=\"dialog-input-title\">{{$t('shelf.groupName')}}</span>\n            </div>\n            <div class=\"dialog-input-wrapper\">\n                <div class=\"dialog-input-inner-wrapper\">\n                    <input type=\"text\" class=\"dialog-input\" v-model=\"newGroupName\" ref=\"dialogInput\">\n                    <div class=\"dialog-input-clear-wrapper\" @click=\"clear\" v-show=\"newGroupName.length > 0\">\n                        <span class=\"icon-close-circle-fill\"></span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div slot=\"btn\" class=\"group-dialog-btn-wrapper\">\n            <div class=\"dialog-btn\" @click=\"hide\">{{$t('shelf.cancel')}}</div>\n            <div class=\"dialog-btn\" @click=\"createNewGroup\" :class=\"{'is-empty': newGroupName.length === 0}\"\n                 v-if=\"ifNewGroup\">{{$t('shelf.confirm')}}\n            </div>\n        </div>\n    </ebook-dialog>\n</template>\n\n<script>\n    import EbookDialog from '../common/Dialog'\n    import { storeShelfMixin } from '../../utils/mixin'\n    import { removeAddFromShelf, appendAddToShelf } from '../../utils/store'\n    import { saveBookShelf } from '../../utils/localstorage'\n\n    export default {\n        name: 'group-dialog',\n        mixins: [storeShelfMixin],\n        components: {\n            EbookDialog\n        },\n        props: {\n            isInGroup: {\n                type: Boolean,\n                default: false\n            }\n        },\n        computed: {\n            defaultCategory() {\n                return [\n                    {\n                        title: this.$t('shelf.newGroup'),\n                        edit: 1\n                    },\n                    {\n                        title: this.$t('shelf.groupOut'),\n                        edit: 2\n                    }\n                ]\n            },\n            category() {\n                return this.shelfList.filter(item => item.type === 2)\n            },\n            categoryList() {\n                return [...this.defaultCategory, ...this.category]\n            },\n            title() {\n                return !this.ifNewGroup ? this.$t('shelf.moveBook') : this.$t('shelf.newGroup')\n            }\n        },\n        data() {\n            return {\n                ifNewGroup: false,\n                newGroupName: ''\n            }\n        },\n        methods: {\n            show() {\n                this.$refs.dialog.show()\n            },\n            hide() {\n                this.$refs.dialog.hide()\n                this.ifNewGroup = false\n            },\n            onGroupClick(item) {\n                if (item.edit && item.edit === 1) {\n                    this.ifNewGroup = true\n                } else if (item.edit && item.edit === 2) {\n                    this.moveOutFromGroup(item)\n                } else {\n                    this.moveToGroup(item)\n                }\n            },\n            clear() {\n                this.newGroupName = ''\n            },\n            moveToGroup(group) {\n                this.setShelfList(this.shelfList\n                .filter(book => this.shelfSelected.indexOf(book) < 0))\n                .then(() => {\n                    if (group && group.itemList) {\n                        group.itemList = [...group.itemList, ...this.shelfSelected]\n                    }\n                    group.itemList.forEach((item, index) => {\n                        item.id = index + 1\n                    })\n                    this.simpleToast(this.$t('shelf.moveBookInSuccess').replace('$1', group.title))\n                    this.onComplete()\n                })\n            },\n            moveOutFromGroup(item) {\n            },\n            createNewGroup() {\n                if (!this.newGroupName && this.newGroupName.length === 0) {\n                    return\n                }\n                const group = {\n                    id: this.shelfList[this.shelfList.length - 2].id + 1,\n                    itemList: [],\n                    selected: false,\n                    title: this.newGroupName,\n                    type: 2\n                }\n                const list = removeAddFromShelf(this.shelfList)\n                list.push(group)\n                this.setShelfList(appendAddToShelf(list))\n                this.onComplete()\n            },\n            onComplete() {\n                saveBookShelf(this.shelfList)\n                this.hide()\n                this.setIsEditMode(false)\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\n    @import \"../../assets/styles/global\";\n\n    .dialog-list-wrapper {\n        width: 100%;\n        padding: 0 px2rem(20);\n        box-sizing: border-box;\n        font-size: px2rem(14);\n        @include scroll;\n\n        .dialog-list-item {\n            display: flex;\n            padding: px2rem(15) 0;\n            box-sizing: border-box;\n            color: #666;\n\n            &.is-add {\n                color: $color-blue;\n\n                &:active {\n                    color: $color-blue-transparent;\n                }\n            }\n\n            &:active {\n                color: rgba(102, 102, 102, .5)\n            }\n\n            .dialog-list-item-text {\n                flex: 1;\n            }\n\n            .dialog-list-icon-wrapper {\n                flex: 0 0 px2rem(30);\n                color: $color-blue;\n                @include right;\n            }\n        }\n    }\n\n    .dialog-new-group-wrapper {\n        width: 100%;\n        padding: 0 px2rem(20);\n        box-sizing: border-box;\n\n        .dialog-input-title-wrapper {\n            font-size: px2rem(10);\n            margin-top: px2rem(20);\n        }\n\n        .dialog-input-wrapper {\n            width: 100%;\n            padding: 0 0 px2rem(30) 0;\n            box-sizing: border-box;\n\n            .dialog-input-inner-wrapper {\n                display: flex;\n                width: 100%;\n                padding: px2rem(10) 0;\n                box-sizing: border-box;\n                border-bottom: px2rem(1) solid #eee;\n                font-size: px2rem(14);\n                color: #666;\n\n                .dialog-input {\n                    flex: 1;\n                    border: none;\n\n                    &:focus {\n                        outline: none;\n                    }\n                }\n\n                .dialog-input-clear-wrapper {\n                    flex: 0 0 px2rem(30);\n                    color: #ccc;\n                    @include center;\n\n                    &:active {\n                        color: #999;\n                    }\n                }\n            }\n        }\n    }\n\n    .group-dialog-btn-wrapper {\n        width: 100%;\n        @include center;\n    }\n\n    .dialog-btn {\n        flex: 1;\n\n        &.is-empty {\n            color: rgba(255, 255, 255, .5);\n        }\n\n        &:active {\n            color: rgba(255, 255, 255, .5)\n        }\n    }\n</style>\n"]}]}