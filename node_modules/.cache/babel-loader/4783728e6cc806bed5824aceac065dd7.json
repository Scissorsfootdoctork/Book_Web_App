{"remainingRequest":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js!/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/components/shelf/shelf.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/components/shelf/shelf.vue","mtime":1591408282679},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.filter\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ShelfCategory from '@/components/shelf/shelfCategory';\nimport ShelfImage from '@/components/shelf/shelfImage';\nimport { realPx } from '@/utils/utils';\nimport { flatBookList } from '@/utils/book';\nexport default {\n  props: {\n    data: Array,\n    isEditMode: Boolean,\n    showType: {\n      type: Number,\n      default: 0\n    }\n  },\n  components: {\n    ShelfCategory: ShelfCategory,\n    ShelfImage: ShelfImage\n  },\n  computed: {\n    bookData: function bookData() {\n      if (this.showType === 0) {\n        return this.data;\n      } else if (this.showType === 1) {\n        return flatBookList(this.data);\n      }\n    },\n    publicNumber: function publicNumber() {\n      if (this.data) {\n        var number = 0;\n        this.data.filter(function (item) {\n          if (!item.private && item.type === 1) {\n            number++;\n          } else if (item.type === 2 && item.itemList.length > 0) {\n            number += item.itemList.filter(function (subItem) {\n              return !subItem.private && subItem.type === 1;\n            }).length;\n          }\n        });\n        return number;\n      } else {\n        return 0;\n      }\n    },\n    privateNumber: function privateNumber() {\n      if (this.data) {\n        var number = 0;\n        this.data.filter(function (item) {\n          if (item.private && item.type === 1) {\n            number++;\n          } else if (item.type === 2 && item.itemList.length > 0) {\n            number += item.itemList.filter(function (subItem) {\n              return subItem.private && subItem.type === 1;\n            }).length;\n          }\n        });\n        return number;\n      } else {\n        return 0;\n      }\n    },\n    purchaseData: function purchaseData() {\n      var bought = {\n        label: this.$t('shelf.bought'),\n        bookList: this.flatData.filter(function (item) {\n          return item.cache;\n        }),\n        isFixed: false\n      };\n      var notPurchased = {\n        label: this.$t('shelf.notPurchased'),\n        bookList: this.flatData.filter(function (item) {\n          return !item.cache;\n        }),\n        isFixed: false\n      };\n      return [bought, notPurchased];\n    },\n    bookShelfList: function bookShelfList() {\n      return this.$refs.bookShelfList[0].getBoundingClientRect().height;\n    },\n    bookShelfList2: function bookShelfList2() {\n      return this.$refs.bookShelfList[1].getBoundingClientRect().height;\n    }\n  },\n  methods: {\n    fixTitle: function fixTitle(offsetY) {\n      if (this.showType === 2 || this.showType === 3) {\n        if (offsetY > realPx(10) && offsetY < this.bookShelfList) {\n          if (this.purchaseData[0].isFixed === false) {\n            this.purchaseData[0].isFixed = true;\n            this.purchaseData[1].isFixed = false;\n            this.$forceUpdate();\n          }\n        } else if (offsetY >= this.bookShelfList - realPx(42)) {\n          if (this.purchaseData[1].isFixed === false) {\n            this.purchaseData[0].isFixed = false;\n            this.purchaseData[1].isFixed = true;\n            this.$forceUpdate();\n          }\n        } else {\n          this.purchaseData[0].isFixed = false;\n          this.purchaseData[1].isFixed = false;\n          this.$forceUpdate();\n        }\n      }\n    },\n    onBookClick: function onBookClick(item, index) {\n      if (item.type === 3) {\n        this.$router.push('/book-store/home');\n      } else if (item.type === 1) {\n        if (this.isEditMode) {\n          item.selected = !item.selected;\n        } else {\n          this.$emit('onBookClick', item, index);\n        }\n      } else if (item.type === 2) {\n        if (!this.isEditMode) {\n          this.$router.push({\n            path: '/book-store/category',\n            query: {\n              index: index\n            }\n          });\n        }\n      }\n    }\n  }\n};",{"version":3,"sources":["shelf.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"book-shelf-wrapper\">\n        <transition-group name=\"list\"\n                          tag=\"div\"\n                          id=\"book-shelf-list\"\n                          v-if=\"showType === 0 || showType === 1\">\n            <div class=\"book-shelf-item\" v-for=\"(item, index) in bookData\" :key=\"item.id\"\n                 @click=\"onBookClick(item, index)\">\n                <div class=\"book-img-wrapper\" :class=\"{'add-book': item.type === 3, 'category-book': item.type ===2}\"\n                     ref=\"bookImg\">\n                    <shelf-image :data=\"item\" :isEditMode=\"isEditMode\" v-if=\"item.type === 1\"></shelf-image>\n                    <shelf-category :data=\"item\" :isEditMode=\"isEditMode\" v-else-if=\"item.type === 2\"></shelf-category>\n                    <span class=\"icon-add icon\" v-else></span>\n                </div>\n                <div class=\"book-title-wrapper\">\n                    <span class=\"book-title title-small\">{{item.title}}</span>\n                </div>\n            </div>\n        </transition-group>\n        <div class=\"book-shelf-label-list-wrapper\" v-if=\"showType === 2 || showType === 3\">\n            <div class=\"book-shelf-list-wrapper\" v-for=\"(item, index) in purchaseData\" :key=\"index\" ref=\"bookShelfList\">\n                <div class=\"book-shelf-label-item\" :class=\"{'is-fixed': item.isFixed}\">\n                    <span class=\"book-shelf-label-text\">{{item.label}}</span>\n                </div>\n                <div class=\"book-shelf-item-wrapper\">\n                    <div class=\"book-shelf-item\" v-for=\"(subItem, subIndex) in item.bookList\" :key=\"subItem.id\"\n                         @click=\"onBookClick(subItem, subIndex)\">\n                        <div class=\"book-img-wrapper\"\n                             :class=\"{'add-book': subItem.type === 3, 'category-book': subItem.type ===2}\"\n                             ref=\"bookImg\">\n                            <shelf-image :data=\"subItem\" :isEditMode=\"isEditMode\"\n                                         v-if=\"subItem.type === 1\"></shelf-image>\n                            <shelf-category :data=\"subItem\" :isEditMode=\"isEditMode\"\n                                            v-else-if=\"subItem.type === 2\"></shelf-category>\n                            <span class=\"icon-add icon\" v-else></span>\n                        </div>\n                        <div class=\"book-title-wrapper\">\n                            <span class=\"book-title title-small\">{{subItem.title}}</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"book-shelf-statistics\" v-show=\"showType === 0\">{{$t('shelf.statistic').replace('$1',\n            publicNumber).replace('$2', privateNumber)}}\n        </div>\n    </div>\n</template>\n\n<script>\n  import ShelfCategory from '@/components/shelf/shelfCategory'\n  import ShelfImage from '@/components/shelf/shelfImage'\n  import { realPx } from '@/utils/utils'\n  import { flatBookList } from '@/utils/book'\n\n  export default {\n    props: {\n      data: Array,\n      isEditMode: Boolean,\n      showType: {\n        type: Number,\n        default: 0\n      }\n    },\n    components: {\n      ShelfCategory,\n      ShelfImage\n    },\n    computed: {\n      bookData() {\n        if (this.showType === 0) {\n          return this.data\n        } else if (this.showType === 1) {\n          return flatBookList(this.data)\n        }\n      },\n      publicNumber() {\n        if (this.data) {\n          let number = 0\n          this.data.filter(item => {\n            if (!item.private && item.type === 1) {\n              number++\n            } else if (item.type === 2 && item.itemList.length > 0) {\n              number += item.itemList.filter(subItem => {\n                return !subItem.private && subItem.type === 1\n              }).length\n            }\n          })\n          return number\n        } else {\n          return 0\n        }\n      },\n      privateNumber() {\n        if (this.data) {\n          let number = 0\n          this.data.filter(item => {\n            if (item.private && item.type === 1) {\n              number++\n            } else if (item.type === 2 && item.itemList.length > 0) {\n              number += item.itemList.filter(subItem => {\n                return subItem.private && subItem.type === 1\n              }).length\n            }\n          })\n          return number\n        } else {\n          return 0\n        }\n      },\n      purchaseData() {\n        const bought = {\n          label: this.$t('shelf.bought'),\n          bookList: this.flatData.filter(item => item.cache),\n          isFixed: false\n        }\n        const notPurchased = {\n          label: this.$t('shelf.notPurchased'),\n          bookList: this.flatData.filter(item => !item.cache),\n          isFixed: false\n        }\n        return [bought, notPurchased]\n      },\n      bookShelfList() {\n        return this.$refs.bookShelfList[0].getBoundingClientRect().height\n      },\n      bookShelfList2() {\n        return this.$refs.bookShelfList[1].getBoundingClientRect().height\n      }\n    },\n    methods: {\n      fixTitle(offsetY) {\n        if (this.showType === 2 || this.showType === 3) {\n          if (offsetY > realPx(10) && offsetY < this.bookShelfList) {\n            if (this.purchaseData[0].isFixed === false) {\n              this.purchaseData[0].isFixed = true\n              this.purchaseData[1].isFixed = false\n              this.$forceUpdate()\n            }\n          } else if (offsetY >= this.bookShelfList - realPx(42)) {\n            if (this.purchaseData[1].isFixed === false) {\n              this.purchaseData[0].isFixed = false\n              this.purchaseData[1].isFixed = true\n              this.$forceUpdate()\n            }\n          } else {\n            this.purchaseData[0].isFixed = false\n            this.purchaseData[1].isFixed = false\n            this.$forceUpdate()\n          }\n        }\n      },\n      onBookClick(item, index) {\n        if (item.type === 3) {\n          this.$router.push('/book-store/home')\n        } else if (item.type === 1) {\n          if (this.isEditMode) {\n            item.selected = !item.selected\n          } else {\n            this.$emit('onBookClick', item, index)\n          }\n        } else if (item.type === 2) {\n          if (!this.isEditMode) {\n            this.$router.push({\n              path: '/book-store/category',\n              query: {\n                index: index\n              }\n            })\n          }\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\n    @import \"../../assets/styles/global\";\n\n    .book-shelf-wrapper {\n        width: 100%;\n        overflow: auto;\n        font-size: 0;\n\n        #book-shelf-list {\n            display: flex;\n            flex-flow: row wrap;\n            width: 100%;\n            padding: 0 px2rem(15);\n            box-sizing: border-box;\n\n            .book-shelf-item {\n                flex: 0 0 33.33%;\n                width: 33.33%;\n                padding: px2rem(15);\n                box-sizing: border-box;\n\n                &.list-move {\n                    transition: transform .5s;\n                }\n\n                &.list-leave-active {\n                    display: none;\n                }\n\n                .book-img-wrapper {\n                    width: 100%;\n                    @include shelfImgHeight;\n                    box-shadow: px2rem(2) px2rem(2) px2rem(6) px2rem(2) rgba(200, 200, 200, .3);\n                    @include center;\n                    border: px2rem(1) solid #eee;\n                    box-sizing: border-box;\n\n                    &.add-book {\n                        box-shadow: none;\n                        border: px2rem(1) solid #ccc;\n                        box-sizing: border-box;\n                    }\n\n                    &.category-book {\n                        border: px2rem(1) solid #eee;\n                        box-sizing: border-box;\n                    }\n\n                    .book-img {\n                        width: 100%;\n                        height: 100%;\n                    }\n\n                    .icon-add {\n                        font-size: px2rem(40);\n                        color: #ccc;\n                    }\n                }\n\n                .book-title-wrapper {\n                    .book-title {\n                        margin-top: px2rem(10);\n                    }\n                }\n            }\n        }\n\n        .book-shelf-statistics {\n            margin: px2rem(30) 0 px2rem(20) 0;\n            text-align: center;\n            font-size: px2rem(12);\n            color: #999;\n        }\n\n        .book-shelf-label-list-wrapper {\n            width: 100%;\n\n            .book-shelf-list-wrapper {\n                position: relative;\n                width: 100%;\n\n                .book-shelf-label-item {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    z-index: 120;\n                    width: 100%;\n                    height: px2rem(42);\n                    border-top: px2rem(1) solid #eee;\n                    border-bottom: none;\n                    box-sizing: border-box;\n                    background: white;\n\n                    &.is-fixed {\n                        position: fixed;\n                        top: px2rem(93);\n                        left: 0;\n                        border-bottom: px2rem(1) solid #eee;\n                    }\n\n                    @include left;\n\n                    .book-shelf-label-text {\n                        font-size: px2rem(14);\n                        color: #666;\n                        margin: 0 px2rem(15);\n                    }\n                }\n\n                .book-shelf-item-wrapper {\n                    position: relative;\n                    z-index: 110;\n                    display: flex;\n                    flex-flow: row wrap;\n                    width: 100%;\n                    padding: px2rem(42) px2rem(15) 0 px2rem(15);\n                    box-sizing: border-box;\n\n                    .book-shelf-item {\n                        flex: 0 0 33.33%;\n                        width: 33.33%;\n                        padding: px2rem(15);\n                        box-sizing: border-box;\n\n                        &.list-move {\n                            transition: transform .5s;\n                        }\n\n                        &.list-leave-active {\n                            display: none;\n                        }\n\n                        .book-img-wrapper {\n                            width: 100%;\n                            @include shelfImgHeight;\n                            box-shadow: px2rem(2) px2rem(2) px2rem(6) px2rem(2) rgba(200, 200, 200, .3);\n                            @include center;\n                            border: px2rem(1) solid #eee;\n                            box-sizing: border-box;\n\n                            &.add-book {\n                                box-shadow: none;\n                                border: px2rem(1) solid #ccc;\n                                box-sizing: border-box;\n                            }\n\n                            &.category-book {\n                                border: px2rem(1) solid #eee;\n                                box-sizing: border-box;\n                            }\n\n                            .book-img {\n                                width: 100%;\n                                height: 100%;\n                            }\n\n                            .icon-add {\n                                font-size: px2rem(40);\n                                color: #ccc;\n                            }\n                        }\n\n                        .book-title-wrapper {\n                            .book-title {\n                                margin-top: px2rem(10);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n</style>\n"],"sourceRoot":"src/components/shelf"}]}