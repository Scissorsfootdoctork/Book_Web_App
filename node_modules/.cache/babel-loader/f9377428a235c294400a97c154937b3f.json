{"remainingRequest":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js!/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/views/store/bookHome.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/views/store/bookHome.vue","mtime":1541580605000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport FlapCard from '@/components/home/flapCard';\nimport SearchBar from '@/components/home/searchBar';\nimport GuessYouLike from '@/components/home/guessYouLike';\nimport Recommend from '@/components/home/recommend';\nimport Featured from '@/components/home/featured';\nimport CategoryBook from '@/components/home/categoryBook';\nimport Category from '@/components/home/category';\nimport { home2 } from '@/api/book';\nimport { realPx } from '@/utils/utils';\nimport { getLocalStorage, setLocalStorage, getHome, saveHome } from '@/utils/localStorage';\nexport default {\n  components: {\n    Category: Category,\n    CategoryBook: CategoryBook,\n    Featured: Featured,\n    FlapCard: FlapCard,\n    SearchBar: SearchBar,\n    GuessYouLike: GuessYouLike,\n    Recommend: Recommend\n  },\n  data: function data() {\n    return {\n      isBack: false,\n      ifFlapCardShow: false,\n      ifShowSearchPage: false,\n      ifShowHotSearch: true,\n      data: null,\n      guessYouLike: null,\n      bannerStyle: null,\n      recommend: null,\n      featured: null,\n      categoryList: null,\n      categories: null,\n      random: null,\n      randomList: null,\n      bookListOffsetY: 0\n    };\n  },\n  methods: {\n    onBack: function onBack() {\n      this.isBack = true;\n    },\n    handleBookListScroll: function handleBookListScroll(e) {\n      var target = e.target;\n\n      if (target) {\n        this.bookListOffsetY = target.scrollTop;\n\n        if (target.scrollTop > 0) {\n          if (this.$refs.searchBar) {\n            this.$refs.searchBar.showSearchPage();\n            this.$refs.searchBar.showShadow();\n            this.ifShowHotSearch = false;\n          }\n        } else {\n          if (this.$refs.searchBar) {\n            this.$refs.searchBar.hideSearchPage();\n          }\n        }\n      }\n    },\n    showFlapCard: function showFlapCard() {\n      var _this = this;\n\n      this.ifFlapCardShow = true;\n      var randomNumber = parseInt(Math.random() * this.randomList.length);\n      this.random = this.randomList[randomNumber];\n      this.$nextTick(function () {\n        _this.$refs.flapCard.startAnimation();\n      });\n    },\n    closeFlapCard: function closeFlapCard() {\n      this.$refs.flapCard.stopAnimation();\n      this.ifFlapCardShow = false;\n    },\n    parseHomeData: function parseHomeData(data) {\n      var _this2 = this;\n\n      this.data = data;\n      this.guessYouLike = data.guessYouLike;\n      this.recommend = data.recommend;\n      this.featured = data.featured;\n      this.categoryList = data.categoryList;\n      this.categories = data.categories;\n      this.randomList = data.random;\n      this.bannerStyle = {\n        backgroundImage: 'url(' + data.banner + ')'\n      };\n      this.$nextTick(function () {\n        if (_this2.bookListOffsetY) {\n          _this2.$refs.bookListWrapper.scrollTo(0, _this2.bookListOffsetY);\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    var home = getHome();\n\n    if (home) {\n      this.parseHomeData(home);\n    } else {\n      home2().then(function (response) {\n        if (response.status === 200 && response.data) {\n          _this3.parseHomeData(response.data);\n\n          saveHome(response.data);\n        }\n      });\n    }\n\n    this.$refs.bookListWrapper.style.height = window.innerHeight - realPx(52) + 'px';\n    this.$refs.bookListWrapper.addEventListener('scroll', this.handleBookListScroll);\n    this.bookListOffsetY = getLocalStorage('offsetY');\n  },\n  beforeRouteEnter: function beforeRouteEnter(to, from, next) {\n    next(function (vm) {\n      if (from.path === '/book-store/list' && from.query.keyword) {\n        vm.ifShowSearchPage = true;\n        vm.$refs.searchBar.setKeyword(from.query.keyword);\n      }\n    });\n  },\n  beforeDestroy: function beforeDestroy() {\n    if (this.bookListOffsetY && !this.isBack) {\n      setLocalStorage('offsetY', this.bookListOffsetY);\n    } else {\n      setLocalStorage('offsetY', 0);\n    }\n  }\n};",{"version":3,"sources":["bookHome.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"book-home\">\n    <search-bar @showFlapCard=\"showFlapCard\"\n                :ifShowSearchPage.sync=\"ifShowSearchPage\"\n                :ifShowHotSearch.sync=\"ifShowHotSearch\"\n                :bookListOffsetY=\"bookListOffsetY\"\n                @back=\"onBack\"\n                ref=\"searchBar\"></search-bar>\n    <div class=\"book-list-wrapper\" v-show=\"!ifShowSearchPage || !ifShowHotSearch\" ref=\"bookListWrapper\">\n      <div class=\"banner-wrapper\">\n        <div class=\"banner\" :style=\"bannerStyle\"></div>\n      </div>\n      <guess-you-like :data=\"guessYouLike\" ref=\"guessYouLike\"></guess-you-like>\n      <recommend class=\"recommend\" :data=\"recommend\" ref=\"recommend\"></recommend>\n      <featured class=\"featured\" :data=\"featured\" :titleText=\"$t('home.featured')\" :btnText=\"$t('home.seeAll')\"\n                ref=\"featured\"></featured>\n      <div class=\"category-list-wrapper\" v-for=\"(item, index) in categoryList\" :key=\"index\">\n        <category-book :data=\"item\"></category-book>\n      </div>\n      <category class=\"category\" :data=\"categories\"></category>\n    </div>\n    <flap-card v-if=\"ifFlapCardShow\"\n               @close=\"closeFlapCard\"\n               :data=\"random\"\n               ref=\"flapCard\"></flap-card>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  import FlapCard from '@/components/home/flapCard'\n  import SearchBar from '@/components/home/searchBar'\n  import GuessYouLike from '@/components/home/guessYouLike'\n  import Recommend from '@/components/home/recommend'\n  import Featured from '@/components/home/featured'\n  import CategoryBook from '@/components/home/categoryBook'\n  import Category from '@/components/home/category'\n  import { home2 } from '@/api/book'\n  import { realPx } from '@/utils/utils'\n  import { getLocalStorage, setLocalStorage, getHome, saveHome } from '@/utils/localStorage'\n\n  export default {\n    components: {\n      Category,\n      CategoryBook,\n      Featured,\n      FlapCard,\n      SearchBar,\n      GuessYouLike,\n      Recommend\n    },\n    data() {\n      return {\n        isBack: false,\n        ifFlapCardShow: false,\n        ifShowSearchPage: false,\n        ifShowHotSearch: true,\n        data: null,\n        guessYouLike: null,\n        bannerStyle: null,\n        recommend: null,\n        featured: null,\n        categoryList: null,\n        categories: null,\n        random: null,\n        randomList: null,\n        bookListOffsetY: 0\n      }\n    },\n    methods: {\n      onBack() {\n        this.isBack = true\n      },\n      handleBookListScroll(e) {\n        const target = e.target\n        if (target) {\n          this.bookListOffsetY = target.scrollTop\n          if (target.scrollTop > 0) {\n            if (this.$refs.searchBar) {\n              this.$refs.searchBar.showSearchPage()\n              this.$refs.searchBar.showShadow()\n              this.ifShowHotSearch = false\n            }\n          } else {\n            if (this.$refs.searchBar) {\n              this.$refs.searchBar.hideSearchPage()\n            }\n          }\n        }\n      },\n      showFlapCard() {\n        this.ifFlapCardShow = true\n        const randomNumber = parseInt(Math.random() * this.randomList.length)\n        this.random = this.randomList[randomNumber]\n        this.$nextTick(() => {\n          this.$refs.flapCard.startAnimation()\n        })\n      },\n      closeFlapCard() {\n        this.$refs.flapCard.stopAnimation()\n        this.ifFlapCardShow = false\n      },\n      parseHomeData(data) {\n        this.data = data\n        this.guessYouLike = data.guessYouLike\n        this.recommend = data.recommend\n        this.featured = data.featured\n        this.categoryList = data.categoryList\n        this.categories = data.categories\n        this.randomList = data.random\n        this.bannerStyle = {\n          backgroundImage: 'url(' + data.banner + ')'\n        }\n        this.$nextTick(() => {\n          if (this.bookListOffsetY) {\n            this.$refs.bookListWrapper.scrollTo(0, this.bookListOffsetY)\n          }\n        })\n      }\n    },\n    mounted() {\n      const home = getHome()\n      if (home) {\n        this.parseHomeData(home)\n      } else {\n        home2().then(response => {\n          if (response.status === 200 && response.data) {\n            this.parseHomeData(response.data)\n            saveHome(response.data)\n          }\n        })\n      }\n      this.$refs.bookListWrapper.style.height = window.innerHeight - realPx(52) + 'px'\n      this.$refs.bookListWrapper.addEventListener('scroll', this.handleBookListScroll)\n      this.bookListOffsetY = getLocalStorage('offsetY')\n    },\n    beforeRouteEnter(to, from, next) {\n      next(vm => {\n        if (from.path === '/book-store/list' && from.query.keyword) {\n          vm.ifShowSearchPage = true\n          vm.$refs.searchBar.setKeyword(from.query.keyword)\n        }\n      })\n    },\n    beforeDestroy() {\n      if (this.bookListOffsetY && !this.isBack) {\n        setLocalStorage('offsetY', this.bookListOffsetY)\n      } else {\n        setLocalStorage('offsetY', 0)\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\n  @import \"../../assets/styles/global\";\n\n  .book-home {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    background: #fff;\n    font-size: px2rem(16);\n    color: #666;\n    .book-list-wrapper {\n      width: 100%;\n      overflow-x: hidden;\n      overflow-y: scroll;\n      -webkit-overflow-scrolling: touch;\n      &::-webkit-scrollbar {\n        display: none;\n      }\n      .banner-wrapper {\n        width: 100%;\n        padding: px2rem(10);\n        box-sizing: border-box;\n        .banner {\n          width: 100%;\n          height: px2rem(150);\n          background-repeat: no-repeat;\n          background-size: 100% 100%;\n        }\n      }\n      .recommend {\n        margin-top: px2rem(20);\n      }\n      .featured {\n        margin-top: px2rem(20);\n      }\n      .category-list-wrapper {\n        margin-top: px2rem(20);\n      }\n      .category {\n        margin-top: px2rem(20);\n      }\n    }\n  }\n</style>\n"],"sourceRoot":"src/views/store"}]}