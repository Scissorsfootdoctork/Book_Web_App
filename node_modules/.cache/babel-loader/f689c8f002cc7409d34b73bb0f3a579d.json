{"remainingRequest":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js!/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/eslint-loader/index.js??ref--13-0!/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/utils/mixin.js","dependencies":[{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/utils/mixin.js","mtime":1590881464323},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.object.define-property\";\nimport \"core-js/modules/es6.object.define-properties\";\nimport \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.array.some\";\nimport \"core-js/modules/es6.string.starts-with\";\nimport \"core-js/modules/es6.array.filter\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.for-each\";\nimport _defineProperty from \"/Users/kscissorfootdoctor/Desktop/Book_Web_App/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { mapGetters, mapActions } from 'vuex';\nimport { FONT_SIZE_LIST, FONT_FAMILY, themeList as _themeList, getReadTimeByMinute, showBookDetail as _showBookDetail } from \"./book\";\nimport { addCss, removeAllCss } from \"./utils\";\nimport * as Storage from \"./localStorage\";\nexport var ebookMixin = {\n  computed: _objectSpread(_objectSpread({}, mapGetters(['fileName', 'menuVisible', 'settingVisible', 'defaultFontSize', 'defaultFontFamily', 'fontFamilyVisible', 'defaultTheme', 'bookAvailable', 'progress', 'section', 'isPaginating', 'currentBook', 'navigation', 'cover', 'metadata', 'paginate', 'pagelist', 'offsetY', 'isBookmark', 'speakingIconBottom'])), {}, {\n    themeList: function themeList() {\n      return _themeList(this);\n    },\n    getSectionName: function getSectionName() {\n      if (this.section) {\n        var section = this.currentBook.section(this.section);\n\n        if (section && section.href && this.currentBook && this.currentBook.navigation) {\n          // return this.currentBook.navigation.get(section.href).label\n          return this.navigation[this.section].label;\n        }\n      }\n    }\n  }),\n  data: function data() {\n    return {\n      fontSizeList: FONT_SIZE_LIST,\n      fontFamily: FONT_FAMILY\n    };\n  },\n  methods: _objectSpread(_objectSpread({}, mapActions(['setFileName', 'setMenuVisible', 'setSettingVisible', 'setDefaultFontSize', 'setDefaultFontFamily', 'setFontFamilyVisible', 'setDefaultTheme', 'setBookAvailable', 'setProgress', 'setSection', 'setIsPaginating', 'setCurrentBook', 'setNavigation', 'setCover', 'setMetadata', 'setPaginate', 'setPagelist', 'setOffsetY', 'setIsBookmark', 'setSpeakingIconBottom'])), {}, {\n    showFontFamilySetting: function showFontFamilySetting() {\n      this.setFontFamilyVisible(true);\n    },\n    showSetting: function showSetting(key) {\n      this.setSettingVisible(key);\n    },\n    hideMenuVisible: function hideMenuVisible() {\n      this.setMenuVisible(false);\n      this.setSettingVisible(-1);\n      this.setFontFamilyVisible(false);\n    },\n    toggleMenuVisible: function toggleMenuVisible() {\n      if (this.menuVisible) {\n        this.setSettingVisible(-1);\n        this.setFontFamilyVisible(false);\n      }\n\n      this.setMenuVisible(!this.menuVisible);\n    },\n    hideFontFamilySetting: function hideFontFamilySetting() {\n      this.setFontFamilyVisible(false);\n    },\n    setGlobalTheme: function setGlobalTheme(theme) {\n      removeAllCss();\n\n      switch (theme) {\n        case 'Default':\n          addCss(\"\".concat(process.env.VUE_APP_RES_URL, \"/theme/theme_default.css\"));\n          break;\n\n        case 'Eye':\n          addCss(\"\".concat(process.env.VUE_APP_RES_URL, \"/theme/theme_eye.css\"));\n          break;\n\n        case 'Gold':\n          addCss(\"\".concat(process.env.VUE_APP_RES_URL, \"/theme/theme_gold.css\"));\n          break;\n\n        case 'Night':\n          addCss(\"\".concat(process.env.VUE_APP_RES_URL, \"/theme/theme_night.css\"));\n          break;\n\n        default:\n          this.setDefaultTheme('Default');\n          addCss(\"\".concat(process.env.VUE_APP_RES_URL, \"/theme/theme_default.css\"));\n          break;\n      }\n    },\n    registerTheme: function registerTheme() {\n      var _this = this;\n\n      this.themeList.forEach(function (theme) {\n        _this.currentBook.rendition.themes.register(theme.name, theme.style);\n      });\n    },\n    switchTheme: function switchTheme() {\n      var _this2 = this;\n\n      var rules = this.themeList.filter(function (theme) {\n        return theme.name === _this2.defaultTheme;\n      })[0];\n\n      if (this.defaultFontFamily && this.defaultFontFamily !== 'Default') {\n        rules.style.body['font-family'] = \"\".concat(this.defaultFontFamily, \"!important\");\n      } else {\n        rules.style.body['font-family'] = \"Times New Roman!important\";\n      }\n\n      this.registerTheme();\n      this.currentBook.rendition.themes.select(this.defaultTheme);\n      this.currentBook.rendition.themes.fontSize(this.defaultFontSize);\n      this.setGlobalTheme(this.defaultTheme);\n    },\n    setFontSize: function setFontSize(fontSize) {\n      var _this3 = this;\n\n      this.setDefaultFontSize(fontSize).then(function () {\n        _this3.switchTheme();\n\n        Storage.saveFontSize(_this3.fileName, fontSize);\n      });\n    },\n    setTheme: function setTheme(theme) {\n      var _this4 = this;\n\n      this.setDefaultTheme(theme).then(function () {\n        _this4.switchTheme();\n\n        Storage.saveTheme(_this4.fileName, theme);\n      });\n    },\n    setFontFamily: function setFontFamily(font) {\n      var _this5 = this;\n\n      this.setDefaultFontFamily(font).then(function () {\n        _this5.switchTheme();\n\n        Storage.saveFontFamily(_this5.fileName, font);\n      });\n    },\n    displaySection: function displaySection(cb) {\n      var _this6 = this;\n\n      var section = this.currentBook.section(this.section);\n\n      if (section && section.href) {\n        this.currentBook.rendition.display(section.href).then(function () {\n          _this6.refreshLocation();\n\n          if (cb) cb();\n        });\n      }\n    },\n    displayProgress: function displayProgress() {\n      var _this7 = this;\n\n      var cfi = this.currentBook.locations.cfiFromPercentage(this.progress / 100);\n      this.currentBook.rendition.display(cfi).then(function () {\n        _this7.refreshLocation();\n      });\n    },\n    display: function display(target) {\n      var _this8 = this;\n\n      var highlight = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (target) {\n        this.currentBook.rendition.display(target).then(function () {\n          if (highlight) {\n            if (target.startsWith('epubcfi')) {\n              _this8.currentBook.getRange(target).then(function (range) {\n                _this8.currentBook.rendition.annotations.highlight(target, {}, function (e) {});\n              });\n            }\n          }\n\n          _this8.refreshLocation();\n        });\n      } else {\n        this.currentBook.rendition.display().then(function () {\n          _this8.refreshLocation();\n        });\n      }\n\n      this.hideMenuVisible();\n    },\n    refreshLocation: function refreshLocation() {\n      var currentLocation = this.currentBook.rendition.currentLocation();\n\n      if (currentLocation.start && currentLocation.start.index) {\n        this.setSection(currentLocation.start.index);\n        var progress = this.currentBook.locations.percentageFromCfi(currentLocation.start.cfi);\n        this.setProgress(Math.floor(progress * 100));\n\n        if (this.pagelist) {\n          if (currentLocation.start.location <= 0) {\n            this.setPaginate('');\n          } else {\n            this.setPaginate(currentLocation.start.location + ' / ' + this.pagelist.length);\n          }\n        } else {\n          this.setPaginate('');\n        }\n\n        var cfistart = currentLocation.start.cfi;\n        var bookmark = Storage.getBookmark(this.fileName);\n\n        if (bookmark) {\n          if (bookmark.some(function (item) {\n            return item.cfi === cfistart;\n          })) {\n            this.setIsBookmark(true);\n          } else {\n            this.setIsBookmark(false);\n          }\n        } else {\n          this.setIsBookmark(false);\n        }\n\n        Storage.saveLocation(this.fileName, cfistart);\n      }\n    },\n    getReadTime: function getReadTime() {\n      return this.$t('book.haveRead').replace('$1', getReadTimeByMinute(this.fileName));\n    }\n  })\n};\nexport var ebookHome = {\n  methods: {\n    showBookDetail: function showBookDetail(item) {\n      _showBookDetail(this, item);\n    }\n  }\n};",{"version":3,"sources":["/Users/kscissorfootdoctor/Desktop/Book_Web_App/src/utils/mixin.js"],"names":["mapGetters","mapActions","FONT_SIZE_LIST","FONT_FAMILY","themeList","getReadTimeByMinute","showBookDetail","addCss","removeAllCss","Storage","ebookMixin","computed","getSectionName","section","currentBook","href","navigation","label","data","fontSizeList","fontFamily","methods","showFontFamilySetting","setFontFamilyVisible","showSetting","key","setSettingVisible","hideMenuVisible","setMenuVisible","toggleMenuVisible","menuVisible","hideFontFamilySetting","setGlobalTheme","theme","process","env","VUE_APP_RES_URL","setDefaultTheme","registerTheme","forEach","rendition","themes","register","name","style","switchTheme","rules","filter","defaultTheme","defaultFontFamily","body","select","fontSize","defaultFontSize","setFontSize","setDefaultFontSize","then","saveFontSize","fileName","setTheme","saveTheme","setFontFamily","font","setDefaultFontFamily","saveFontFamily","displaySection","cb","display","refreshLocation","displayProgress","cfi","locations","cfiFromPercentage","progress","target","highlight","startsWith","getRange","range","annotations","e","currentLocation","start","index","setSection","percentageFromCfi","setProgress","Math","floor","pagelist","location","setPaginate","length","cfistart","bookmark","getBookmark","some","item","setIsBookmark","saveLocation","getReadTime","$t","replace","ebookHome"],"mappings":"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","sourcesContent":["import { mapGetters, mapActions } from 'vuex'\nimport {\n  FONT_SIZE_LIST,\n  FONT_FAMILY,\n  themeList,\n  getReadTimeByMinute,\n  showBookDetail\n} from './book'\nimport { addCss, removeAllCss } from './utils'\nimport * as Storage from './localStorage'\n\nexport const ebookMixin = {\n  computed: {\n    ...mapGetters([\n      'fileName',\n      'menuVisible',\n      'settingVisible',\n      'defaultFontSize',\n      'defaultFontFamily',\n      'fontFamilyVisible',\n      'defaultTheme',\n      'bookAvailable',\n      'progress',\n      'section',\n      'isPaginating',\n      'currentBook',\n      'navigation',\n      'cover',\n      'metadata',\n      'paginate',\n      'pagelist',\n      'offsetY',\n      'isBookmark',\n      'speakingIconBottom'\n    ]),\n    themeList() {\n      return themeList(this)\n    },\n    getSectionName() {\n      if (this.section) {\n        const section = this.currentBook.section(this.section)\n        if (section && section.href && this.currentBook &&\n              this.currentBook.navigation) {\n          // return this.currentBook.navigation.get(section.href).label\n          return this.navigation[this.section].label\n        }\n      }\n    }\n  },\n  data() {\n    return {\n      fontSizeList: FONT_SIZE_LIST,\n      fontFamily: FONT_FAMILY\n    }\n  },\n  methods: {\n    ...mapActions([\n      'setFileName',\n      'setMenuVisible',\n      'setSettingVisible',\n      'setDefaultFontSize',\n      'setDefaultFontFamily',\n      'setFontFamilyVisible',\n      'setDefaultTheme',\n      'setBookAvailable',\n      'setProgress',\n      'setSection',\n      'setIsPaginating',\n      'setCurrentBook',\n      'setNavigation',\n      'setCover',\n      'setMetadata',\n      'setPaginate',\n      'setPagelist',\n      'setOffsetY',\n      'setIsBookmark',\n      'setSpeakingIconBottom'\n    ]),\n    showFontFamilySetting() {\n      this.setFontFamilyVisible(true)\n    },\n    showSetting(key) {\n      this.setSettingVisible(key)\n    },\n    hideMenuVisible() {\n      this.setMenuVisible(false)\n      this.setSettingVisible(-1)\n      this.setFontFamilyVisible(false)\n    },\n    toggleMenuVisible() {\n      if (this.menuVisible) {\n        this.setSettingVisible(-1)\n        this.setFontFamilyVisible(false)\n      }\n      this.setMenuVisible(!this.menuVisible)\n    },\n    hideFontFamilySetting() {\n      this.setFontFamilyVisible(false)\n    },\n    setGlobalTheme(theme) {\n      removeAllCss()\n      switch (theme) {\n        case 'Default':\n          addCss(\n                `${process.env.VUE_APP_RES_URL}/theme/theme_default.css`)\n          break\n        case 'Eye':\n          addCss(`${process.env.VUE_APP_RES_URL}/theme/theme_eye.css`)\n          break\n        case 'Gold':\n          addCss(\n                `${process.env.VUE_APP_RES_URL}/theme/theme_gold.css`)\n          break\n        case 'Night':\n          addCss(\n                `${process.env.VUE_APP_RES_URL}/theme/theme_night.css`)\n          break\n        default:\n          this.setDefaultTheme('Default')\n          addCss(\n                `${process.env.VUE_APP_RES_URL}/theme/theme_default.css`)\n          break\n      }\n    },\n    registerTheme() {\n      this.themeList.forEach(theme => {\n        this.currentBook.rendition.themes.register(theme.name,\n              theme.style)\n      })\n    },\n    switchTheme() {\n      const rules = this.themeList.filter(\n            theme => theme.name === this.defaultTheme)[0]\n      if (this.defaultFontFamily && this.defaultFontFamily !==\n            'Default') {\n        rules.style.body['font-family'] = `${this.defaultFontFamily}!important`\n      } else {\n        rules.style.body['font-family'] = `Times New Roman!important`\n      }\n      this.registerTheme()\n      this.currentBook.rendition.themes.select(this.defaultTheme)\n      this.currentBook.rendition.themes.fontSize(this.defaultFontSize)\n      this.setGlobalTheme(this.defaultTheme)\n    },\n    setFontSize(fontSize) {\n      this.setDefaultFontSize(fontSize).then(() => {\n        this.switchTheme()\n        Storage.saveFontSize(this.fileName, fontSize)\n      })\n    },\n    setTheme(theme) {\n      this.setDefaultTheme(theme).then(() => {\n        this.switchTheme()\n        Storage.saveTheme(this.fileName, theme)\n      })\n    },\n    setFontFamily(font) {\n      this.setDefaultFontFamily(font).then(() => {\n        this.switchTheme()\n        Storage.saveFontFamily(this.fileName, font)\n      })\n    },\n    displaySection(cb) {\n      const section = this.currentBook.section(this.section)\n      if (section && section.href) {\n        this.currentBook.rendition.display(section.href).then(() => {\n          this.refreshLocation()\n          if (cb) cb()\n        })\n      }\n    },\n    displayProgress() {\n      const cfi = this.currentBook.locations.cfiFromPercentage(\n            this.progress / 100)\n      this.currentBook.rendition.display(cfi).then(() => {\n        this.refreshLocation()\n      })\n    },\n    display(target, highlight = false) {\n      if (target) {\n        this.currentBook.rendition.display(target).then(() => {\n          if (highlight) {\n            if (target.startsWith('epubcfi')) {\n              this.currentBook.getRange(target).then(range => {\n                this.currentBook.rendition.annotations.highlight(\n                      target, {}, (e) => {\n                      })\n              })\n            }\n          }\n          this.refreshLocation()\n        })\n      } else {\n        this.currentBook.rendition.display().then(() => {\n          this.refreshLocation()\n        })\n      }\n      this.hideMenuVisible()\n    },\n    refreshLocation() {\n      const currentLocation = this.currentBook.rendition.currentLocation()\n      if (currentLocation.start && currentLocation.start.index) {\n        this.setSection(currentLocation.start.index)\n        const progress = this.currentBook.locations.percentageFromCfi(\n              currentLocation.start.cfi)\n        this.setProgress(Math.floor(progress * 100))\n        if (this.pagelist) {\n          if (currentLocation.start.location <= 0) {\n            this.setPaginate('')\n          } else {\n            this.setPaginate(\n                  currentLocation.start.location + ' / ' +\n                  this.pagelist.length)\n          }\n        } else {\n          this.setPaginate('')\n        }\n        const cfistart = currentLocation.start.cfi\n        const bookmark = Storage.getBookmark(this.fileName)\n        if (bookmark) {\n          if (bookmark.some(item => item.cfi === cfistart)) {\n            this.setIsBookmark(true)\n          } else {\n            this.setIsBookmark(false)\n          }\n        } else {\n          this.setIsBookmark(false)\n        }\n        Storage.saveLocation(this.fileName, cfistart)\n      }\n    },\n    getReadTime() {\n      return this.$t('book.haveRead')\n      .replace('$1', getReadTimeByMinute(this.fileName))\n    }\n  }\n}\n\nexport const ebookHome = {\n  methods: {\n    showBookDetail(item) {\n      showBookDetail(this, item)\n    }\n  }\n}\n"]}]}